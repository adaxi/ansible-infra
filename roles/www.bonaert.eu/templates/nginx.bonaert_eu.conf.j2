server {
       listen           80;
       listen           [::]:80;
       server_name      {{bonaert_eu_domain}} www.{{bonaert_eu_domain}};
       return           301 https://$server_name$request_uri;
}

server {
    listen              443 ssl;
    listen              [::]:443 ssl;
   	ssl_certificate     /etc/{{ "letsencrypt" if installation_environment == "production" else "selfsigned" }}/live/{{bonaert_eu_domain}}/fullchain.pem;
    ssl_certificate_key /etc/{{ "letsencrypt" if installation_environment == "production" else "selfsigned" }}/live/{{bonaert_eu_domain}}/privkey.pem;
    keepalive_timeout   70;

    server_name         {{bonaert_eu_domain}} www.{{bonaert_eu_domain}};
    root                {{bonaert_eu_home}};
    access_log          /var/log/nginx/{{bonaert_eu_domain}}.access.log	combined;
    error_log           /var/log/nginx/{{bonaert_eu_domain}}.error.log    error;

    location / {
        index           index.html index.php;
    }

    # deny access to .dotfiles files
    location ~ /\. {
        deny            all;
        access_log      off;
        log_not_found   off;
    }

	# Cache image and scripts
	location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        expires         max;
        log_not_found   off;
    }

}
